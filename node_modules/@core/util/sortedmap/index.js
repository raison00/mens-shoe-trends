{
  // + options - options object
  // + desc - boolean
  function getSortFunc(opts, desc) {
    const options = opts || {};

    const type = options.type;
    const comparator = options.comparator;
    const byValue = options.byValue;

    return function (pair1, pair2) {
      const sortBy = byValue ? 'value' : 'key';
      let p1 = pair1[sortBy];
      let p2 = pair2[sortBy];
      let retValue;

      if (comparator) {
        retValue = comparator(p1, p2);
      } else {
        if (type) {
          p1 = type(p1);
          p2 = type(p2);
        }

        if (p1 < p2) {
          retValue = -1;
        } else if (p1 > p2) {
          retValue = 1;
        } else {
          retValue = 0;
        }
      }

      if (desc) {
        retValue *= -1;
      }

      return retValue;
    };
  }

  // #### getSortedMap - a public method to convert an object to a sorted array
  // > It converts {"k1": "v1", "k2": "v2"}
  // > to
  // >   [{"key": "k1", "value": "v1"}, {"key": "k2", "value": "v2"}]
  // > sorting order can be customized with options
  // >
  // > parameters
  // >
  // + obj - an object (map) that we want to convert
  // + options - an optional object (comparator will override type)
  //           {
  //                comparator: function, - comparator function
  //                type: Type, [e.g Number] - convert to Numbers before comparing
  //                byValue: boolean, [default ordering is on keys] - if it true, then sort values
  //                order: "DESC" [default ordering is Ascending ]
  //            }
  //
  // > returns - Array
  // >
  function getSortedMap(object, opts) {
    const arr = [];

    const obj = object || {};
    const options = opts || {};

    arr.isSortedMap = true;
    arr.get = function (key) {
      return obj[key];
    };

    if (obj) {
      Object.keys(obj).forEach((prop) => {
        arr.push({
          key: prop,
          value: obj[prop],
        });
      });
      arr.sort(getSortFunc(options, options.order === 'DESC'));
    }

    return arr;
  }

  module.exports = {
    getSortedMap,
  };
}
