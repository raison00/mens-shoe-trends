/* eslint-disable no-console */

/**
 * Error handler for controlling process flow in the server.
 *
 * Should be called internally from within the libs to handle errors correctly.
 * Captures errors and continues or exits process flow appropriately.
 *
 * Should only be called with fatal=true if absolutely necessary, as it kills the server.
 */
const chalk = require('chalk');

module.exports = (err, fatal = false) => {
  const non = fatal ? '' : 'Non-';

  console.log(chalk.bold.red(`${non}Fatal Error:`));
  console.error(chalk.red(err));

  if (fatal) {
    console.log(chalk.bold.red('No choice but to exit fatally.'));
    process.exit(1);
  }
};
